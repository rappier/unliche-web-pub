(function(window,undefined){var UnlicheSDKLib=window.UnlicheSDK;UnlicheSDKLib.listen=function(){if(arguments.length==1){callAPI(arguments[0])}else{callAPI(arguments[0],arguments[1])}};UnlicheSDKLib.transactionListen=function(){if(arguments.length==1){sendTransaction(arguments[0])}else{sendTransaction(arguments[0],arguments[1])}};UnlicheSDKLib.saveBrowserInfo=function(apiKey,mode){UnlicheSDKLib.ApiKey=apiKey;UnlicheSDKLib.cookie.write("SDK_MODE",mode,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("API_KEY",apiKey,1,window.location.hostname,null);setBrowserInfo(apiKey,mode)};UnlicheSDKLib.savePageInfo=function(pageUrl){UnlicheSDKLib.cookie.write("page_url",pageUrl,24,window.location.hostname,null)};UnlicheSDKLib.getGAId=function(){return UnlicheSDKLib.cookie.read("trck_id")};UnlicheSDKLib.getSubleadId=function(){return UnlicheSDKLib.cookie.read("sub_lead_id")};UnlicheSDKLib.setUserIdForMultitouch=function(userID){UnlicheSDKLib.cookie.write("user_id",userID,1,window.location.hostname,null)};function callAPI(){var xhr=createCORSRequest("POST",CONFIG.get("BASE_URL")+CONFIG.get("API_VERSION")+CONFIG.get("Method_Name"));xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr.setRequestHeader("t1k",CONFIG.get("API_TAC"));xhr.setRequestHeader("tAc",UnlicheSDKLib.cookie.read("API_KEY"));xhr.onload=function(){if(xhr.status===200){}else if(xhr.status!==200){}};var timeStampInMs=window.performance&&window.performance.now&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.now()+window.performance.timing.navigationStart:Date.now();var requestJsonWithMethod={};var requestJson={};if(arguments.length==1){if(arguments[0]!=0){requestJson["event_id"]=arguments[0]}}else{requestJson["event_id"]=arguments[0];requestJson["category"]=arguments[1]}requestJson["client_id"]=UnlicheSDKLib.cookie.read("Client_ID");requestJson["mtouchid"]=UnlicheSDKLib.cookie.read("user_id");requestJson["page_request_hits"]=window.performance.getEntries().length;requestJson["session_id"]=UnlicheSDKLib.cookie.read("session_id");var transactionId=UnlicheSDKLib.cookie.read("transaction_id");if(transactionId.indexOf("&sess_id")!==-1){transactionId=transactionId.split("&sess_id")[0]}requestJson["transaction_id"]=transactionId;requestJson["os_type"]=CONFIG.get("OS_TYPE");requestJson["timestamp"]=Date.now().toString();requestJson["domain_name"]=window.location.hostname;var pageURL=UnlicheSDKLib.cookie.read("page_url");if(pageURL.indexOf("?")!==-1){pageURL=pageURL.split("?")[0]}var setMode=UnlicheSDKLib.cookie.read("SDK_MODE");if(setMode==null){setMode="live"}requestJson["env_mode"]=setMode;requestJson["page_url"]=pageURL;var finalJson="";finalJson=JSON.stringify(requestJson).concat(JSON.stringify(getSessionBrowserInfo(UnlicheSDKLib.cookie.read("Client_ID"))));finalJson=finalJson.replace('"}"{','\\", ');finalJson=finalJson.replace(/\\/g,"");requestJsonWithMethod=finalJson.substring(0,finalJson.length-1);var testMode="test";if(transactionId){xhr.send(CONFIG.get("Method_Name")+"="+finalJson.substring(0,finalJson.length-1))}else if(setMode.indexOf(testMode)!==-1){xhr.send(CONFIG.get("Method_Name")+"="+finalJson.substring(0,finalJson.length-1))}}function sendTransaction(transCost){var xhr=createCORSRequest("POST",CONFIG.get("BASE_URL")+CONFIG.get("API_VERSION")+CONFIG.get("Method_Name"));xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xhr.setRequestHeader("t1k",CONFIG.get("API_TAC"));xhr.setRequestHeader("tAc",UnlicheSDKLib.cookie.read("API_KEY"));var timeStampInMs=window.performance&&window.performance.now&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.now()+window.performance.timing.navigationStart:Date.now();var requestJsonWithMethod={};var requestJson={};requestJson["event_id"]=CONSTENT.get("TRANSACTIONEV_ID");requestJson["client_id"]=UnlicheSDKLib.cookie.read("Client_ID");requestJson["mtouchid"]=UnlicheSDKLib.cookie.read("user_id");if(arguments.length==1){requestJson["purchase_value"]=arguments[0]}else{requestJson["purchase_value"]=arguments[0];requestJson["category"]=arguments[1]}requestJson["page_request_hits"]=window.performance.getEntries().length;requestJson["session_id"]=UnlicheSDKLib.cookie.read("session_id");var transactionId=UnlicheSDKLib.cookie.read("transaction_id");if(transactionId.indexOf("&sess_id")!==-1){transactionId=transactionId.split("&sess_id")[0]}requestJson["transaction_id"]=transactionId;requestJson["os_type"]=CONFIG.get("OS_TYPE");requestJson["timestamp"]=Date.now().toString();requestJson["domain_name"]=window.location.hostname;var pageURL=UnlicheSDKLib.cookie.read("page_url");if(pageURL.indexOf("?")!==-1){pageURL=pageURL.split("?")[0]}var setMode=UnlicheSDKLib.cookie.read("SDK_MODE");if(setMode==null){setMode="live"}requestJson["env_mode"]=setMode;requestJson["page_url"]=pageURL;var finalJson="";finalJson=JSON.stringify(requestJson).concat(JSON.stringify(getSessionBrowserInfo(UnlicheSDKLib.cookie.read("Client_ID"))));finalJson=finalJson.replace('"}"{','\\", ');finalJson=finalJson.replace(/\\/g,"");requestJsonWithMethod=finalJson.substring(0,finalJson.length-1);var testMode="test";if(transactionId){xhr.send(CONFIG.get("Method_Name")+"="+finalJson.substring(0,finalJson.length-1))}else if(setMode.indexOf(testMode)!==-1){xhr.send(CONFIG.get("Method_Name")+"="+finalJson.substring(0,finalJson.length-1))}xhr.onload=function(){if(xhr.status===200){}else if(xhr.status!==200){}}}function createCORSRequest(method,url){var xhr=new XMLHttpRequest;if("withCredentials"in xhr){xhr.open(method,url,true)}else if(typeof XDomainRequest!="undefined"){xhr=new XDomainRequest;xhr.open(method,url)}else{xhr=null}return xhr}function setBrowserInfo(APIKey,mode){var nVer=navigator.appVersion;var nAgt=navigator.userAgent;var browserName=navigator.appName;var fullVersion=""+parseFloat(navigator.appVersion);var majorVersion=parseInt(navigator.appVersion,10);var nameOffset,verOffset,ix;if((verOffset=nAgt.indexOf("Opera"))!=-1){browserName="Opera";fullVersion=nAgt.substring(verOffset+6);if((verOffset=nAgt.indexOf("Version"))!=-1)fullVersion=nAgt.substring(verOffset+8)}else if((verOffset=nAgt.indexOf("MSIE"))!=-1){browserName="Microsoft Internet Explorer";fullVersion=nAgt.substring(verOffset+5)}else if((verOffset=nAgt.indexOf("Chrome"))!=-1){browserName="Chrome";fullVersion=nAgt.substring(verOffset+7)}else if((verOffset=nAgt.indexOf("Safari"))!=-1){browserName="Safari";fullVersion=nAgt.substring(verOffset+7);if((verOffset=nAgt.indexOf("Version"))!=-1)fullVersion=nAgt.substring(verOffset+8)}else if((verOffset=nAgt.indexOf("Firefox"))!=-1){browserName="Firefox";fullVersion=nAgt.substring(verOffset+8)}else if((nameOffset=nAgt.lastIndexOf(" ")+1)<(verOffset=nAgt.lastIndexOf("/"))){browserName=nAgt.substring(nameOffset,verOffset);fullVersion=nAgt.substring(verOffset+1);if(browserName.toLowerCase()==browserName.toUpperCase()){browserName=navigator.appName}}if((ix=fullVersion.indexOf(";"))!=-1)fullVersion=fullVersion.substring(0,ix);if((ix=fullVersion.indexOf(" "))!=-1)fullVersion=fullVersion.substring(0,ix);majorVersion=parseInt(""+fullVersion,10);if(isNaN(majorVersion)){fullVersion=""+parseFloat(navigator.appVersion);majorVersion=parseInt(navigator.appVersion,10)}var OSName="Unknown OS";if(navigator.appVersion.indexOf("Win")!=-1)OSName="Windows";if(navigator.appVersion.indexOf("Mac")!=-1)OSName="MacOS";if(navigator.appVersion.indexOf("X11")!=-1)OSName="UNIX";if(navigator.appVersion.indexOf("Linux")!=-1)OSName="Linux";var browserInfoJson={};browserInfoJson["browser_name"]=browserName;browserInfoJson["full_version"]=fullVersion;browserInfoJson["app_name"]=navigator.appName;browserInfoJson["user_agent"]=navigator.userAgent;browserInfoJson["platform"]=navigator.platform;browserInfoJson["browser_language"]=navigator.language;browserInfoJson["os_name"]=OSName;var sesSionId=getParameterByName("sess_id");var source=getParameterByName("utm_source");var medium=getParameterByName("utm_medium");var campaign=getParameterByName("utm_campaign");var terms=getParameterByName("utm_term");var content=getParameterByName("utm_content");var transaction=getParameterByName("transaction_id");var trck_id=getParameterByName("trck_id");var subLeadId=getParameterByName("sub_lead_id");if(sesSionId==="no"){var date=new Date;var sessionId="UNL_"+source+"_"+Math.floor(Math.random()*1e3)+date.getTime();UnlicheSDKLib.cookie.write("session_id",sessionId,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("utm_source",source,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("utm_medium",medium,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("utm_campaign",campaign,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("utm_term",terms,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("utm_content",content,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("transaction_id",transaction,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("sub_lead_id",subLeadId,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("SDK_MODE",mode,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("API_KEY",APIKey,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("trck_id",trck_id,1,window.location.hostname,null)}else if(sesSionId&&sesSionId!==""&&sessionId!==null&&sessionId!=="null"){UnlicheSDKLib.cookie.write("session_id",sesSionId,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("utm_source",source,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("utm_medium",medium,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("utm_campaign",campaign,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("utm_term",terms,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("utm_content",content,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("transaction_id",transaction,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("sub_lead_id",subLeadId,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("SDK_MODE",mode,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("API_KEY",APIKey,1,window.location.hostname,null);UnlicheSDKLib.cookie.write("trck_id",trck_id,1,window.location.hostname,null)}var browsersInfoData=JSON.stringify(browserInfoJson);var clientID=browserName+"/"+fullVersion+"_"+window.location.hostname;UnlicheSDKLib.cookie.write("Client_ID",clientID,1,window.location.hostname,null);setSessionBrowserInfo(clientID,browsersInfoData)}function getParameterByName(name){var url_string=document.URL;var url=new URL(url_string);if(url.searchParams){var value=url.searchParams.get(name)}else{var value=""}return value}function setSessionBrowserInfo(clietnID,infoJson){sessionStorage.setItem(clietnID,infoJson);callAPI(0)}function getSessionBrowserInfo(clietnID){return sessionStorage.getItem(clietnID)}var checkCanSessionStorage=function(){var mod="modernizr";try{sessionStorage.setItem(mod,mod);sessionStorage.removeItem(mod);return true}catch(e){return false}};var checkCookieWritable=function(domain){try{document.cookie="cookietest=1"+(domain?"; domain="+domain:"");var ret=document.cookie.indexOf("cookietest=")!=-1;document.cookie="cookietest=1; expires=Thu, 19-Jan-2018 00:00:01 GMT"+(domain?"; domain="+domain:"");return ret}catch(e){return false}};UnlicheSDKLib.cookie={write:function(name,value,days,domain,path){var date=new Date;days=days;path=path||"/";date.setTime(date.getTime()+days*24*60*60*1e3);var expires="; expires="+date.toGMTString();var cookieValue=name+"="+value+expires+"; path="+path;if(domain){cookieValue+="; domain="+domain}document.cookie=cookieValue},read:function(c_name){var allCookie=""+document.cookie;var index=allCookie.indexOf(c_name);if(c_name===undefined||c_name===""||index===-1)return"";var ind1=allCookie.indexOf(";",index);if(ind1==-1)ind1=allCookie.length;return unescape(allCookie.substring(index+c_name.length+1,ind1))},remove:function(name){if(this.read(name)){this.write(name,"",-1,"/")}}};var CONFIG=function(){var private={OS_TYPE:4,API_TAC:"V1A2U3L4T5S6D7K8",Method_Name:"webevntrk",BASE_URL:"https://t.unlc.co/",API_VERSION:"v1/web/"};return{get:function(name){return private[name]}}}();var CONSTENT=function(){var private={TRANSACTIONEV_ID:104};return{get:function(name){return private[name]}}}()})(this);
